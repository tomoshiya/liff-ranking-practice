<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ã¯ã˜ã‚ã¦ã®LIFFã‚¢ãƒ—ãƒª</title>
    
    <!-- LIFFã®ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’èª­ã¿è¾¼ã‚€ï¼ˆLINEãŒæä¾›ã—ã¦ã„ã‚‹ã‚‚ã®ï¼‰ -->
    <script charset="utf-8" src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>
    
    <style>
        /* ãƒ‡ã‚¶ã‚¤ãƒ³è¨­å®š */
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
            max-width: 600px;
            margin: 0 auto;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        
        .container {
            background: white;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }
        
        h1 {
            color: #333;
            text-align: center;
            margin-bottom: 30px;
        }
        
        .info-box {
            background: #f0f4ff;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
        }
        
        .info-box h2 {
            color: #667eea;
            font-size: 18px;
            margin-top: 0;
        }
        
        .info-box p {
            color: #555;
            font-size: 16px;
            margin: 10px 0;
        }
        
        button {
            background: #06c755;
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 10px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            width: 100%;
            margin-top: 10px;
            transition: background 0.3s;
        }
        
        button:hover {
            background: #05b04d;
        }
        
        button:active {
            transform: scale(0.98);
        }
        
        .loading {
            text-align: center;
            color: #666;
            padding: 40px;
        }
        
        .error {
            background: #ffe0e0;
            border: 2px solid #ff6b6b;
            border-radius: 10px;
            padding: 20px;
            color: #c92a2a;
            margin: 20px 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ‰ ã¯ã˜ã‚ã¦ã®LIFFã‚¢ãƒ—ãƒª</h1>
        
        <!-- èª­ã¿è¾¼ã¿ä¸­ã®è¡¨ç¤º -->
        <div id="loading" class="loading">
            <p>èª­ã¿è¾¼ã¿ä¸­...</p>
        </div>
        
        <!-- LINEã§ãƒ­ã‚°ã‚¤ãƒ³ã—ã¦ã„ãªã„å ´åˆã®ã‚¨ãƒ©ãƒ¼è¡¨ç¤º -->
        <div id="error" class="error" style="display: none;">
            <p><strong>ã‚¨ãƒ©ãƒ¼:</strong> ã“ã®ã‚¢ãƒ—ãƒªã¯LINEã‹ã‚‰é–‹ã„ã¦ãã ã•ã„ã€‚</p>
        </div>
        
        <!-- ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ï¼ˆæœ€åˆã¯éè¡¨ç¤ºï¼‰ -->
        <div id="content" style="display: none;">
            <div class="info-box">
                <h2>ğŸ‘¤ ã‚ãªãŸã®æƒ…å ±</h2>
                <p><strong>åå‰:</strong> <span id="userName">---</span></p>
                <p><strong>ãƒ¦ãƒ¼ã‚¶ãƒ¼ID:</strong> <span id="userId">---</span></p>
            </div>
            
            <button onclick="sendMessage()">
                ğŸ’¬ LINEã«ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’é€ã‚‹
            </button>
            
            <button onclick="closeApp()" style="background: #999; margin-top: 10px;">
                âœ• ã‚¢ãƒ—ãƒªã‚’é–‰ã˜ã‚‹
            </button>
        </div>
    </div>

    <script>
        // ========================================
        // ã“ã“ã‹ã‚‰ãŒãƒ—ãƒ­ã‚°ãƒ©ãƒ ã®æœ¬ä½“ã§ã™
        // ========================================
        
        // LIFF IDã‚’ã“ã“ã«å…¥ã‚Œã‚‹ï¼ˆå¾Œã§LINE Developersã‹ã‚‰å–å¾—ã—ã¾ã™ï¼‰
        const LIFF_ID = '2008911809-CBLKsbT1'; // â† ã‚ã¨ã§æ›¸ãæ›ãˆã¾ã™
        
        // LIFFã‚¢ãƒ—ãƒªã‚’åˆæœŸåŒ–ï¼ˆèµ·å‹•ï¼‰ã™ã‚‹
        window.onload = function() {
            initializeLiff();
        };
        
        function initializeLiff() {
            liff.init({
                liffId: LIFF_ID // LIFF IDã‚’ä½¿ã£ã¦åˆæœŸåŒ–
            })
            .then(() => {
                // åˆæœŸåŒ–ãŒæˆåŠŸã—ãŸã‚‰...
                
                // LINEã«ãƒ­ã‚°ã‚¤ãƒ³ã—ã¦ã„ã‚‹ã‹ãƒã‚§ãƒƒã‚¯
                if (liff.isLoggedIn()) {
                    // ãƒ­ã‚°ã‚¤ãƒ³ã—ã¦ã„ã‚‹å ´åˆï¼šãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±ã‚’å–å¾—
                    getUserProfile();
                } else {
                    // ãƒ­ã‚°ã‚¤ãƒ³ã—ã¦ã„ãªã„å ´åˆï¼šãƒ­ã‚°ã‚¤ãƒ³ç”»é¢ã¸
                    liff.login();
                }
            })
            .catch((err) => {
                // ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ãŸå ´åˆ
                console.error('LIFFã®åˆæœŸåŒ–ã«å¤±æ•—ã—ã¾ã—ãŸ:', err);
                document.getElementById('loading').style.display = 'none';
                document.getElementById('error').style.display = 'block';
                document.getElementById('error').innerHTML = 
                    '<p><strong>ã‚¨ãƒ©ãƒ¼:</strong> ' + err.message + '</p>' +
                    '<p>LIFF IDãŒæ­£ã—ãè¨­å®šã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèªã—ã¦ãã ã•ã„ã€‚</p>';
            });
        }
        
        // ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«æƒ…å ±ã‚’å–å¾—ã—ã¦è¡¨ç¤º
        function getUserProfile() {
            liff.getProfile()
                .then(profile => {
                    // ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«å–å¾—æˆåŠŸ
                    document.getElementById('userName').textContent = profile.displayName;
                    document.getElementById('userId').textContent = profile.userId;
                    
                    // èª­ã¿è¾¼ã¿ä¸­ã‚’éè¡¨ç¤ºã€ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚’è¡¨ç¤º
                    document.getElementById('loading').style.display = 'none';
                    document.getElementById('content').style.display = 'block';
                })
                .catch((err) => {
                    console.error('ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«å–å¾—ã«å¤±æ•—ã—ã¾ã—ãŸ:', err);
                    document.getElementById('loading').style.display = 'none';
                    document.getElementById('error').style.display = 'block';
                });
        }
        
        // LINEã«ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’é€ä¿¡ã™ã‚‹
        function sendMessage() {
            if (!liff.isInClient()) {
                // LINEã‚¢ãƒ—ãƒªå†…ã§é–‹ã„ã¦ã„ãªã„å ´åˆ
                alert('ã“ã®æ©Ÿèƒ½ã¯LINEã‚¢ãƒ—ãƒªå†…ã§ã®ã¿ä½¿ç”¨ã§ãã¾ã™');
                return;
            }
            
            // ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’é€ä¿¡
            liff.sendMessages([{
                type: 'text',
                text: 'ğŸ‘‹ ã¯ã˜ã‚ã¦ã®LIFFã‚¢ãƒ—ãƒªã‹ã‚‰é€ä¿¡ã—ã¾ã—ãŸï¼\n\nã“ã‚Œã‹ã‚‰ãµãŸã‚Šã®ã‚‰ã‚“ãã‚“ãã‚¢ãƒ—ãƒªã‚’ä½œã£ã¦ã„ãã¾ã™ ğŸ®'
            }])
            .then(() => {
                alert('ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’é€ä¿¡ã—ã¾ã—ãŸï¼');
            })
            .catch((err) => {
                console.error('ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸é€ä¿¡ã«å¤±æ•—ã—ã¾ã—ãŸ:', err);
                alert('ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®é€ä¿¡ã«å¤±æ•—ã—ã¾ã—ãŸ');
            });
        }
        
        // ã‚¢ãƒ—ãƒªã‚’é–‰ã˜ã‚‹
        function closeApp() {
            liff.closeWindow();
        }
    </script>
</body>
</html>


