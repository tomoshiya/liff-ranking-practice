# 🎮 RankQuest - 開発進捗と引き継ぎ

**最終更新日**: 2026年1月17日  
**開発者**: tomoshiya  
**プロジェクト状態**: フェーズ1完了（LIFF基礎環境構築）

---

## 📊 現在の進捗状況

### ✅ 完了した項目

#### フェーズ1：LIFF環境構築（完了）
- [x] GitHubアカウント作成（ユーザー名: tomoshiya）
- [x] リポジトリ作成：`liff-ranking-practice`
- [x] GitHub Pages設定完了
- [x] LINE Developersアカウント設定
- [x] プロバイダー作成：「練習用」
- [x] チャネル作成：「ランキングアプリ練習」（LINEログイン）
- [x] LIFF設定完了
- [x] 基本LIFFアプリ作成（ユーザー情報表示）
- [x] デプロイ・動作確認完了

### 📍 重要な情報

#### GitHub
- **リポジトリURL**: https://github.com/tomoshiya/liff-ranking-practice
- **GitHub Pages URL**: https://tomoshiya.github.io/liff-ranking-practice/
- **リポジトリタイプ**: Public

#### LINE Developers
- **プロバイダー名**: 練習用
- **チャネル名**: ランキングアプリ練習
- **チャネルタイプ**: LINEログイン
- **LIFF ID**: 2008911809-CBLKsbT1
- **LIFF URL**: https://liff.line.me/2008911809-CBLKsbT1
- **エンドポイントURL**: https://tomoshiya.github.io/liff-ranking-practice/
- **Scope**: openid, profile, chat_message.write

#### ローカルファイル
- **プロジェクトフォルダ**: `C:\Users\rshio\Documents\liff-ranking-practice\`
- **ファイル構成**:
  - `index.html` - LIFFアプリ本体（LIFF ID設定済み）
  - `README.md` - 開発手順書
  - `チェックリスト.md` - 進捗管理
  - `開発進捗と引き継ぎ.md` - このファイル

#### 現在の機能
- ✅ LINEユーザー情報取得（名前、ユーザーID）
- ✅ プロフィール表示
- ✅ LINEメッセージ送信
- ✅ アプリの開閉

---

## 🎯 次回以降の開発計画

### フェーズ2：ランキング入力機能（次回の目標）

#### 実装する機能
1. **お題表示機能**
   - お題リストの作成（@RankQuest（仮）.md から抽出）
   - ランダムまたは選択式でお題を表示
   - お題カテゴリの実装（エモーション、パーソナリティ、カップルなど）

2. **ランキング入力フォーム**
   - 1位〜5位の入力欄
   - 入力バリデーション
   - 送信ボタン

3. **データ保存（ローカルストレージ）**
   - 入力したランキングを保存
   - 保存したランキングの表示
   - 編集・削除機能

4. **UI/UX改善**
   - デザインのブラッシュアップ
   - アニメーション追加
   - レスポンシブ対応

#### 技術スタック
- HTML/CSS/JavaScript（現状維持）
- LocalStorage API（データ保存）
- LIFF SDK（LINE連携）

---

### フェーズ3：データベース連携（中期目標）

#### 検討事項
1. **データベースサービスの選定**
   - Firebase Realtime Database（推奨）
   - Firestore
   - Supabase
   - その他

2. **データ構造設計**
   ```
   users/
     ├─ {userId}/
         ├─ profile: { name, pictureUrl }
         ├─ partnerId: {partnerUserId}
         └─ rankings/
             └─ {rankingId}/
                 ├─ theme: "お題名"
                 ├─ ranking: ["1位", "2位", ...]
                 ├─ createdAt: timestamp
                 └─ status: "submitted" | "guessing" | "completed"
   
   pairs/
     └─ {pairId}/
         ├─ user1Id: {userId}
         ├─ user2Id: {userId}
         ├─ pairCode: "6桁コード"
         └─ createdAt: timestamp
   
   themes/
     └─ {themeId}/
         ├─ title: "お題名"
         ├─ category: "エモーション"
         └─ description: "説明"
   ```

3. **認証とセキュリティ**
   - LINE UserIDをベースとした認証
   - データアクセス権限の設定
   - セキュリティルールの実装

---

### フェーズ4：ペア機能（長期目標）

#### 実装する機能
1. **ペアコード生成**
   - 6桁のユニークコード生成
   - QRコード表示（オプション）

2. **ペア登録**
   - コード入力画面
   - パートナー確認
   - ペア成立通知

3. **データ共有**
   - パートナーのランキング表示
   - 予想入力
   - 答え合わせ

---

### フェーズ5：ゲーム機能（長期目標）

#### 実装する機能
1. **予想システム**
   - パートナーのランキングを3つ予想
   - 予想の送信

2. **答え合わせ**
   - 正解・不正解の判定
   - スコア計算
   - 結果表示

3. **ランキング共有**
   - なぜそのランキングにしたか（コメント機能）
   - 過去のランキング履歴

---

### フェーズ6：自動配信（将来目標）

#### 実装する機能
1. **週1回のお題配信**
   - LINE Messaging APIの利用
   - スケジュール設定（例：毎週日曜日20:00）
   - プッシュ通知

2. **リマインダー**
   - 未回答の場合の通知
   - パートナーが回答した際の通知

---

## 🤔 開発における検討事項

### A. 技術選定

#### 1. データベース
**現在の選択肢**:
- **Firebase** (推奨)
  - メリット: 無料枠が大きい、ドキュメント豊富、初心者向け
  - デメリット: Googleアカウント必要
- **Supabase**
  - メリット: PostgreSQL、オープンソース、REST API
  - デメリット: やや複雑
- **自前サーバー + DB**
  - メリット: 完全な制御
  - デメリット: コスト、保守が大変

**決定時期**: フェーズ3開始前

#### 2. フロントエンド
**現在の状態**:
- Vanilla JavaScript（フレームワークなし）

**将来の選択肢**:
- **このまま Vanilla JS** (推奨)
  - メリット: シンプル、学習コスト低、軽量
  - デメリット: 複雑になると管理が大変
- **React**
  - メリット: コンポーネント管理、エコシステム
  - デメリット: 学習コスト、ビルドが必要
- **Vue.js**
  - メリット: 学習しやすい、段階的導入可能
  - デメリット: ビルド環境

**決定時期**: フェーズ2で複雑さを感じたら検討

#### 3. 自動配信の実装方法
- **LINE Messaging API** (必須)
  - ボットアカウントの作成
  - Push メッセージの送信
- **スケジューラー**
  - Cloud Functions (Firebase)
  - GitHub Actions
  - 専用サーバー (cron)

**決定時期**: フェーズ6開始前

---

### B. 機能設計

#### 1. ペア認証の方法
**選択肢**:
1. **ペアコード方式** (推奨)
   - ユーザーAがコード生成 → ユーザーBが入力
   - メリット: シンプル、確実
   - デメリット: 手動入力が必要

2. **QRコード方式**
   - QRコードを表示 → パートナーがスキャン
   - メリット: 楽、ミスが少ない
   - デメリット: LIFF APIの制限あり

3. **LINE友だちリスト方式**
   - 友だちリストから選択
   - メリット: 最も楽
   - デメリット: LINE APIでは友だちリスト取得不可

**推奨**: ペアコード + QRコード（両方実装）

#### 2. お題の管理方法
**選択肢**:
1. **ハードコード** (短期)
   - JavaScript内に直接記述
   - メリット: 簡単、すぐできる
   - デメリット: 変更が大変

2. **JSONファイル** (中期)
   - themes.json として管理
   - メリット: 管理しやすい、追加が楽
   - デメリット: ファイル管理が必要

3. **データベース** (長期)
   - Firebaseに保存
   - メリット: 動的に追加・編集可能
   - デメリット: 複雑

**推奨**: フェーズ2はハードコード → フェーズ3でJSON → 将来的にDB

#### 3. ランキング予想のタイミング
**選択肢**:
1. **リアルタイム方式**
   - 相手が入力したらすぐ予想可能
   - メリット: 早い、楽しい
   - デメリット: どちらかが先に入力する必要

2. **両者入力完了方式** (推奨)
   - 両者が入力完了してから予想開始
   - メリット: 公平、同時進行感
   - デメリット: 片方が入力しないと進まない

3. **タイムリミット方式**
   - 24時間以内に入力、未入力でも予想開始
   - メリット: 進行が保証される
   - デメリット: 一方的になる可能性

**推奨**: 両者入力完了方式 + リマインダー

---

### C. UI/UX設計

#### 1. 画面遷移
```
┌─────────────────┐
│  ホーム画面      │ ← 最初の画面
│ - 今週のお題     │
│ - ランキング入力 │
│ - 履歴           │
└─────────────────┘
        ↓
┌─────────────────┐
│ ランキング入力   │
│ - お題表示       │
│ - 1位〜5位入力   │
│ - 送信           │
└─────────────────┘
        ↓
┌─────────────────┐
│ 予想待ち画面     │
│ - パートナー待ち │
│ or              │
│ - 予想入力画面   │
└─────────────────┘
        ↓
┌─────────────────┐
│ 結果画面         │
│ - 答え合わせ     │
│ - スコア         │
│ - コメント       │
└─────────────────┘
```

#### 2. デザインテーマ
**参考**: @RankQuest（仮）.md のコンセプト
- 温かみのあるカラー
- 夫婦・カップル向けのビジュアル
- シンプルで分かりやすい

**カラーパレット案**:
- メインカラー: 温かいピンク系 (#FF6B9D)
- サブカラー: 優しいブルー系 (#6BCBFF)
- アクセント: イエロー系 (#FFD93D)
- 背景: 白 or ライトグレー

#### 3. アクセシビリティ
- 大きめのボタン（タップしやすい）
- 読みやすいフォントサイズ（16px以上）
- 色弱対応（色だけに頼らない）
- ローディング表示

---

### D. データ設計

#### 1. ユーザーデータ
```javascript
{
  userId: "LINE_USER_ID",
  profile: {
    displayName: "たろう",
    pictureUrl: "https://...",
    statusMessage: "よろしく"
  },
  partnerId: "PARTNER_LINE_USER_ID", // null if no partner
  pairCode: "ABC123", // 自分が生成したコード
  createdAt: "2026-01-17T10:00:00Z",
  lastLoginAt: "2026-01-17T15:30:00Z"
}
```

#### 2. ランキングデータ
```javascript
{
  rankingId: "ranking_001",
  userId: "LINE_USER_ID",
  theme: "好きな食べ物TOP5",
  themeId: "theme_001",
  ranking: [
    { rank: 1, answer: "寿司" },
    { rank: 2, answer: "ラーメン" },
    { rank: 3, answer: "カレー" },
    { rank: 4, answer: "ピザ" },
    { rank: 5, answer: "ハンバーグ" }
  ],
  status: "submitted", // "submitted" | "guessing" | "completed"
  createdAt: "2026-01-17T10:00:00Z",
  completedAt: null
}
```

#### 3. 予想データ
```javascript
{
  guessId: "guess_001",
  rankingId: "ranking_001", // どのランキングへの予想か
  guesserId: "GUESSER_USER_ID", // 予想する人
  targetUserId: "TARGET_USER_ID", // 予想される人
  guesses: ["寿司", "ラーメン", "焼肉"], // 3つの予想
  result: {
    correctCount: 2,
    correctAnswers: [
      { guess: "寿司", actualRank: 1, isCorrect: true },
      { guess: "ラーメン", actualRank: 2, isCorrect: true },
      { guess: "焼肉", actualRank: null, isCorrect: false }
    ]
  },
  score: 2,
  createdAt: "2026-01-17T11:00:00Z"
}
```

#### 4. お題データ
```javascript
{
  themeId: "theme_001",
  title: "好きな食べ物TOP5",
  category: "パーソナリティ",
  description: "あなたの好きな食べ物・料理をランキング形式で教えてください",
  isActive: true,
  difficulty: "easy", // easy | normal | hard
  createdAt: "2026-01-01T00:00:00Z"
}
```

---

### E. セキュリティとプライバシー

#### 1. データアクセス制御
- **本人のみアクセス可能**: 自分のランキング
- **ペアのみアクセス可能**: パートナーのランキング（入力完了後）
- **公開しない**: ユーザーID以外の個人情報

#### 2. Firebaseセキュリティルール（案）
```javascript
rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {
    // ユーザーは自分のデータのみ読み書き可能
    match /users/{userId} {
      allow read, write: if request.auth.uid == userId;
    }
    
    // ランキングは本人とペアのみアクセス可能
    match /rankings/{rankingId} {
      allow read: if request.auth.uid == resource.data.userId
                  || request.auth.uid == get(/databases/$(database)/documents/users/$(resource.data.userId)).data.partnerId;
      allow write: if request.auth.uid == resource.data.userId;
    }
  }
}
```

#### 3. 個人情報の扱い
- LINE UserIDのみを識別子として使用
- 表示名は表示用のみ、検索などには使わない
- ランキング内容は暗号化しない（カジュアルな内容想定）
- 削除機能の実装（データ削除権の尊重）

---

### F. コストとスケーリング

#### 1. 無料枠の範囲
**Firebase無料プラン (Spark)**:
- Realtime Database: 1GB保存、10GB/月転送
- Cloud Functions: 125,000回/月実行
- Authentication: 無制限

**想定ユーザー数と利用量**:
- ユーザー数: 100組（200人）
- 1人あたりデータ: 約10KB
- 合計: 2MB（1GBの0.2%）

→ **当面は無料で運用可能**

#### 2. 有料化の検討タイミング
- ユーザー数が1,000組を超えた場合
- 画像アップロード機能を追加する場合
- リアルタイム通信を増やす場合

---

### G. 開発環境とツール

#### 1. 必要なツール
- **エディタ**: VSCode（推奨）または任意のテキストエディタ
- **ブラウザ**: Chrome（開発者ツールが優秀）
- **バージョン管理**: Git（将来的に）
- **デバッグ**: LINE Developers のLIFFインスペクター

#### 2. 開発フロー
```
ローカルで開発
  ↓
動作確認（ブラウザ）
  ↓
GitHubにアップロード
  ↓
GitHub Pagesに自動デプロイ
  ↓
LINEで動作確認
```

#### 3. テスト方法
- **ローカル**: ブラウザで index.html を直接開く（LIFF機能は動かない）
- **本番**: LIFF URLで開いて確認
- **将来**: Firebase Local Emulator（フェーズ3以降）

---

## 📝 次回開発時の引き継ぎプロンプト

次回、AIチャットを開始する際に、以下のプロンプトをコピー&ペーストしてください：

```
【引き継ぎ】RankQuest LIFFアプリ開発の続きをお願いします

## 現在の状況
- フェーズ1（LIFF環境構築）が完了しています
- 基本的なLIFFアプリ（ユーザー情報表示）が動作中
- LIFF ID: 2008911809-CBLKsbT1
- GitHub Pages: https://tomoshiya.github.io/liff-ranking-practice/
- プロジェクトフォルダ: C:\Users\rshio\Documents\liff-ranking-practice\

## 開発進捗ドキュメント
C:\Users\rshio\Documents\liff-ranking-practice\開発進捗と引き継ぎ.md に詳細があります。
このファイルを確認して、現在の状況を把握してください。

## 今回やりたいこと
[ここに具体的にやりたいことを記入]

例：
- 「フェーズ2のランキング入力フォームを作りたい」
- 「お題をランダムで表示する機能を追加したい」
- 「Firebaseの設定を始めたい」
- 「デザインを改善したい」
- 「全体設計について相談したい」

## 質問・相談
[あれば記入]

---

非エンジニアなので、丁寧に教えてもらえると助かります。
また、専門用語は分かりやすく説明してください。
日本語で対応してください。
```

---

## 🗂️ ファイル構成

### 現在のファイル
```
liff-ranking-practice/
├─ index.html                  # LIFFアプリ本体（動作中）
├─ README.md                   # 開発手順書（環境構築方法）
├─ チェックリスト.md            # 進捗管理
├─ 開発進捗と引き継ぎ.md        # このファイル（引き継ぎ用）
└─ (将来的に追加予定)
    ├─ themes.json             # お題データ
    ├─ style.css               # スタイルシート分離
    ├─ script.js               # JavaScript分離
    └─ firebase-config.js      # Firebase設定
```

---

## 🎯 おすすめの次回アクションプラン

### オプション1：小さく始める（推奨）
1. **お題表示機能を追加**（1〜2時間）
   - 5〜10個のお題をハードコード
   - ランダム表示
   - 見た目を整える

2. **ランキング入力フォームを作成**（2〜3時間）
   - シンプルな5つの入力欄
   - バリデーション
   - LocalStorageに保存

3. **保存したランキングを表示**（1時間）
   - 履歴画面の作成
   - 削除機能

### オプション2：本格的に進める
1. **Firebaseの導入**（2〜3時間）
   - Firebaseアカウント作成
   - プロジェクト作成
   - Authentication設定
   - Realtime Database設定

2. **データベース連携**（3〜4時間）
   - ユーザー登録
   - ランキング保存・取得
   - リアルタイム同期

### オプション3：設計を詰める
1. **画面設計**（1〜2時間）
   - ワイヤーフレーム作成
   - 画面遷移図
   - UIコンポーネントリスト

2. **データベース設計**（1〜2時間）
   - テーブル設計
   - リレーション設計
   - クエリ設計

---

## 📚 参考リンク

### 公式ドキュメント
- **LIFF**: https://developers.line.biz/ja/docs/liff/
- **LINE Messaging API**: https://developers.line.biz/ja/docs/messaging-api/
- **Firebase**: https://firebase.google.com/docs
- **GitHub Pages**: https://docs.github.com/ja/pages

### 学習リソース
- **LIFF入門**: https://developers.line.biz/ja/docs/liff/getting-started/
- **Firebase + LIFF**: https://firebase.google.com/docs/auth/web/line-oauth
- **JavaScript基礎**: https://developer.mozilla.org/ja/docs/Web/JavaScript

---

## 💭 検討中の課題・疑問点

### 技術的な課題
1. **LINE UserIDでのFirebase認証**
   - カスタム認証トークンの生成方法
   - セキュリティの確保

2. **リアルタイム更新の実装**
   - パートナーが入力したら通知
   - 効率的なデータ監視

3. **オフライン対応**
   - ネットワークエラー時の挙動
   - データの同期

### UX的な課題
1. **初回ユーザーの導線**
   - チュートリアルの必要性
   - ペア登録の分かりやすさ

2. **継続利用の促進**
   - 通知のタイミング
   - リマインダーの頻度

### ビジネス的な課題
1. **収益化の検討**
   - 現時点では不要
   - 将来的にプレミアム機能？

2. **利用規約・プライバシーポリシー**
   - 正式版では必須
   - 弁護士への相談

---

## 🎉 まとめ

### 今日達成したこと
- ✅ LIFF開発環境の完全構築
- ✅ 動作するLIFFアプリの作成
- ✅ LINE連携の確認
- ✅ 全体設計の整理

### 次回に向けて
- 📋 開発進捗ドキュメント完成
- 📋 検討事項の整理完了
- 📋 引き継ぎプロンプト準備完了

### あなたの強み
- 🎮 素晴らしいアイデア（RankQuest）
- 📝 詳細な企画書（ゲームルール、テーマなど）
- 💪 学習意欲と実行力
- 🤝 コミュニケーション能力

**自信を持って次のステップに進んでください！**

---

**作成日**: 2026年1月17日  
**次回更新予定**: 次回開発セッション後


